|Ідентифікатор та назва атаки (вразливості)|Вимога (FR, NFR)|Приклад вразливостей, які може використовувати атака|Приклад запобігання успішної реалізації атаки|
|:---:|:---:|:---|:---|
|A03:2021 – Впровадження|FR 1.1 Введення параметрів пошуку.|Додаток використовує ненадійні дані при створенні наступного вразливого SQL-запиту:<br>```String query = "SELECT * FROM vacancies WHERE category='" + request.getParameter("category") + "'";```<br>У цьому випадку атакуючий встановлює значення параметра 'category' як: ```' DROP TABLE vacancies;--```.<br>Це змінює значення запиту для видалення всієї таблиці з вакансіями.|- Використовуйте позитивну перевірку введення на серверному боці. Це не є повним захистом, оскільки багато додатків потребують спеціальних символів, таких як текстові області або API для мобільних додатків.<br>- Для будь-яких залишкових динамічних запитів видаляйте спеціальні символи, використовуючи конкретний синтаксис екранування для цього інтерпретатора.|
|A05:2021 – Недостатня конфігурація безпеки|FR 1.2 Надсилання параметрів пошуку до серверу при натисканні кнопки "Пошук".|Конфігурація сервера додатка дозволяє повертати докладні повідомлення про помилки, наприклад, стеки викликів, користувачам. Це потенційно розкриває чутливу інформацію або основні дефекти, такі як версії компонентів, які відомо є вразливими.|- Обробка помилок не повинна розкривати стеки викликів або інші надто інформативні повідомлення про помилки користувачам.|
|-|FR 2.1 Введення навичок користувача.|-|-|
|A05:2021 – Недостатня конфігурація безпеки|FR 2.2 Надсилання навичок користувача до серверу при натисканні кнопки "Пошук".|Конфігурація сервера додатка дозволяє повертати докладні повідомлення про помилки, наприклад, стеки викликів, користувачам. Це потенційно розкриває чутливу інформацію або основні дефекти, такі як версії компонентів, які відомо є вразливими.|- Обробка помилок не повинна розкривати стеки викликів або інші надто інформативні повідомлення про помилки користувачам.|
|-|FR 3.1 Відображення списку вакансій.|-|-|
|-|FR 3.2 Перегляд докладного опису вакансії.|-|-|
|-|FR 3.3 Збереження вакансії.|-|-|
|-|FR 3.4 Видалення вакансії.|-|-|
|-|FR 4.1 Перегляд збережених вакансій.|-|-|
|A02:2021 – Криптографічні вади|FR 5.1 Запуск скраперів та оновлення бази даних.|API-ключ є простим рандомно згенерованим рядком. Його можна розкласти за допомогою GPUs методом "грубої сили" або отримати алгоритм генерації.|- Переконайтеся, що встановлені актуальні і надійні стандартні алгоритми, протоколи і ключі; використовуйте належне управління ключами.<br>- Ключі повинні бути генеровані криптографічно випадково та зберігатися в пам'яті у вигляді байтових масивів. Якщо використовується пароль, то його необхідно перетворити в ключ за допомогою відповідної функції отримання ключа на основі пароля.<br>- Переконайтеся, що для відповідних випадків використовується криптографічно випадкова випадковість і її не було засіяно передбачуваним способом або з низькою ентропією. Більшість сучасних API не потребують від розробника засівання CSPRNG для забезпечення безпеки.|
|A05:2021 – Недостатня конфігурація безпеки|FR 5.1 Запуск скраперів та оновлення бази даних.|Список каталогів не вимкнено на сервері. Атакуючий виявляє, що він може просто переглядати каталоги. Атакуючий знаходить і завантажує скомпільовані класи Java, які він розкомпільовує і реверс-інженерить, щоб переглянути код. Потім атакуючий знаходить важливий дефект керування доступом в додатку.|- Мінімальна платформа без непотрібних функцій, компонентів, документації і прикладів. Видаляйте непотрібні функції та фреймворки, які не використовуються, або не встановлюйте їх.<br> - Сегментована архітектура додатку забезпечує ефективне та безпечне розділення між компонентами або орендаторами, за допомогою сегментації, контейнеризації або груп безпеки хмарних обчислень (ACLs).|
|A09:2021 – Недоліки журналювання та моніторингу безпеки|FR 5.1 Запуск скраперів та оновлення бази даних.|- Журнали додатків та API не моніторяться на підозрілу активність.<br>- Журнали зберігаються лише локально.|- Переконайтеся, що всі помилки входу, контролю доступу та валідації введення на серверному боці можуть бути зареєстровані з достатнім контекстом користувача для ідентифікації підозрілих або зловмисних облікових записів та зберігаються довго, щоб забезпечити затриману аналітику.<br>- Переконайтеся, що дані журналу кодуються правильно, щоб запобігти внескам або атакам на системи журналювання або моніторингу.|